# WARNING: This file is auto-generated. Do not modify it manually.
# Generated by: trustyai-garak-distribution/build.py

FROM registry.access.redhat.com/ubi9/python-312:latest
WORKDIR /opt/app-root

RUN pip install sqlalchemy # somehow sqlalchemy[asyncio] is not sufficient
RUN pip install \
    aiosqlite \
    asyncpg \
    autoevals \
    datasets \
    fastapi \
    fire \
    garak==0.12.0 \
    httpx \
    llama_stack_provider_trustyai_garak==0.1.1 \
    openai \
    opentelemetry-exporter-otlp-proto-http \
    opentelemetry-sdk \
    pandas \
    requests \
    sqlalchemy[asyncio] \
    uvicorn
RUN pip install \
    llama_stack_provider_trustyai_garak
RUN pip install --index-url https://download.pytorch.org/whl/cpu torch torchvision
RUN pip install --no-deps sentence-transformers
RUN pip install --no-cache llama-stack==0.2.16
RUN mkdir -p ${HOME}/.llama/providers.d ${HOME}/.cache
COPY trustyai-garak-distribution/run.yaml ${APP_ROOT}/run.yaml
COPY trustyai-garak-distribution/providers.d/ ${HOME}/.llama/providers.d/

ENTRYPOINT ["python", "-m", "llama_stack.distribution.server.server", "--config", "/opt/app-root/run.yaml"]